<div class="dash-header">
    <div class="dash-title">

        <div class="p-field p-grid">
            <div class="p-col-12 p-md-12">
                <div class="welcome-banner">
                    <h3>Benvenuto, {{currentUser.first_name}} {{currentUser.last_name}}</h3>
                </div>
            </div>
            <div class="p-col-12 p-md-3">

            </div>
        </div>

    </div>
</div>
<div class="p-grid">

    <div class="p-col-12 p-md-12">

        <div class="p-field p-grid">

            <div class="p-col-12 p-md-3">

                <p-card>

                    {{clientsCount}}
                    <h4>Clienti</h4>

                    <button pButton pRipple icon="pi pi-list" [routerLink]="['/admin/clients']"
                        routerLinkActive="active" class="p-button p-button-primary p-mr-2"></button>
                    <button pButton pRipple icon="pi pi-plus" [routerLink]="['/admin/clients/create']"
                        routerLinkActive="active" class="p-button p-button-success p-mr-2"></button>
                </p-card>
            </div>
            <div class="p-col-12 p-md-3">

                <p-card>

                    {{appointmentsCount}}

                    <h4>Appuntamenti</h4>
                    <button pButton pRipple icon="pi pi-list" [routerLink]="['/admin/appointments']"
                        routerLinkActive="active" class="p-button p-button-primary p-mr-2"></button>
                    <button pButton pRipple icon="pi pi-plus" [routerLink]="['/admin/appointments/create']"
                        routerLinkActive="active" class="p-button p-button-success p-mr-2"></button>

                </p-card>

            </div>

            <div class="p-col-12 p-md-3">

                <p-card>

                    {{billingsCount}}
                    <h4>Fatturazione</h4>

                    <button pButton pRipple icon="pi pi-list" [routerLink]="['/admin/billings']"
                        routerLinkActive="active" class="p-button p-button-primary p-mr-2"></button>
                    <button pButton pRipple icon="pi pi-plus" [routerLink]="['/admin/billings/create']"
                        routerLinkActive="active" class="p-button p-button-success p-mr-2"></button>
                </p-card>
            </div>
            <div class="p-col-12 p-md-3">

                <p-card>

                    {{productsCount}}

                    <h4>Prodotti</h4>
                    <button pButton pRipple icon="pi pi-list" [routerLink]="['/admin/products']"
                        routerLinkActive="active" class="p-button p-button-primary p-mr-2"></button>
                    <button pButton pRipple icon="pi pi-plus" [routerLink]="['/admin/products/create']"
                        routerLinkActive="active" class="p-button p-button-success p-mr-2"></button>

                </p-card>

            </div>
        </div>

    </div>

    <div class="p-col-12 p-md-6">
        <p-card>
            <div *ngIf="calendarOptions">
                <ng-fullcalendar #ucCalendar [options]="calendarOptions" (eventClick)="eventClick($event.detail)"
                    (dayClick)="dayClick($event.detail)">
                </ng-fullcalendar>
            </div>
        </p-card>
    </div>

    <div class="p-col-12 p-md-6">

        <p-card>

            <div class="p-field p-grid">
                <div class="p-col-12 p-md-12">
                    <h6>Appuntamenti Oggi</h6>
                    <h3 class="date"> {{myDate }}</h3>
                </div>

            </div>
            <hr class="full">

            <p-table #dt1 [value]="appointmentsToday" [paginator]="false" [rows]="10">

                <ng-template pTemplate="body" let-appointment>
                    <tr >
                        <td width="100">
                            <p-tag value="{{appointment.date | date: 'HH:mm' }}" severity="warning"></p-tag>
                        </td>
                        

                        <td width="50" >
                            <app-initials-avatar  (click)="editProduct(appointment)"
                                firstName="{{ getCategoryItem(appointment.category_id)?.name | slice:0:1}}"
                                lastName="{{ getCategoryItem(appointment.category_id)?.surname | slice:0:1}}">
                            </app-initials-avatar>
                        </td>
                        <td> {{ getCategoryItem(appointment.category_id)?.name }}
                            {{ getCategoryItem(appointment.category_id)?.surname }}</td>

                          
                            <td>{{appointment.title}}</td>
                    </tr>
                </ng-template>
            </p-table>

        </p-card>
    </div>
</div>

<p-sidebar [(visible)]="productDialog" position="right" [style]="{width:'50%'}">
    <ng-template pTemplate="content">
        <div class="p-col-12 p-md-12">
            <p-card>
                <div class="p-grid">
                    <div class="p-col-12 p-md-6">
                        <strong> {{displayEvent.event.start | date:'dd/MM/yyyy HH:mm':'-0000'}}</strong>

                        <h3>{{displayEvent.event.title}}</h3>

                        {{ getLocationItem(displayEvent.event.location_id)?.name }}
                        <br> {{ getEmployeeItem(displayEvent.event.employee_id)?.name }}

                        <p [innerHTML]="displayEvent.event.description"></p>

                    </div>
                    <div class="p-col-12 p-md-6">
                        <div *ngFor="let item of displayEvent.event.works_id">
                            {{ getWorksItem(item)?.name }}
                        </div>

                    </div>

                </div>
                <button pButton pRipple icon="pi pi-pencil" label="modifica Appuntamento"
                    class="p-button p-button-success p-mr-2"
                    [routerLink]="['/admin/appointments/edit', displayEvent.event.id]"></button>

            </p-card>
        </div>
        <div class="clearfix"></div><br>
        <div class="clearfix"></div>
        <div class="p-col-12 p-md-12">

            <p-card>
                <strong>{{ getCategoryItem(displayEvent.event.category_id)?.name }}
                    {{ getCategoryItem(displayEvent.event.category_id)?.surname }}</strong>

                <p>{{ getCategoryItem(displayEvent.event.category_id)?.address }}<br>
                    {{ getCategoryItem(displayEvent.event.category_id)?.zip }} -
                    {{ getCategoryItem(displayEvent.event.category_id)?.city }}
                    ({{ getCategoryItem(displayEvent.event.category_id)?.province }})<br>
                </p>
                <hr>
                <p>{{ getCategoryItem(displayEvent.event.category_id)?.phone }}<br>
                    {{ getCategoryItem(displayEvent.event.category_id)?.email }}</p>
                <div class="clearfix"></div>
                <button pButton pRipple icon="pi pi-pencil" label="Modifica Dati Cliente"
                    class="p-button p-button-primary p-mr-2"
                    [routerLink]="['/admin/clients/edit', displayEvent.event.category_id]"></button>
            </p-card>
        </div>

    </ng-template>

</p-sidebar>

<p-sidebar [(visible)]="appointmentsDialog" position="right" [style]="{width:'50%'}">
    <ng-template pTemplate="content">
        <div class="p-col-12 p-md-12">
            <p-card>
                <div class="p-grid">
                    <div class="p-col-12 p-md-6">
                        <strong>{{appointment.date | date:'dd/MM/yyyy HH:mm'}}</strong>

                        <h3>{{appointment.title}}</h3>

                        {{ getLocationItem(appointment.location_id)?.name }}
                        <br> {{ getEmployeeItem(appointment.employee_id)?.name }}

                        <p [innerHTML]="appointment.description"></p>

                    </div>
                    <div class="p-col-12 p-md-6">

                        <div *ngFor="let item of selectedWorks">
                            {{ getWorksItem(item)?.name }}
                        </div>

                    </div>

                </div>
                <button pButton pRipple icon="pi pi-pencil" label="modifica Appuntamento"
                    class="p-button p-button-success p-mr-2"
                    [routerLink]="['/admin/appointments/edit', appointment.id]"></button>

            </p-card>
        </div>
        <div class="clearfix"></div><br>
        <div class="clearfix"></div>
        <div class="p-col-12 p-md-12">

            <p-card>
                <strong>{{ getCategoryItem(appointment.category_id)?.name }}
                    {{ getCategoryItem(appointment.category_id)?.surname }}</strong>

                <p>{{ getCategoryItem(appointment.category_id)?.address }}<br>
                    {{ getCategoryItem(appointment.category_id)?.zip }} -
                    {{ getCategoryItem(appointment.category_id)?.city }}
                    ({{ getCategoryItem(appointment.category_id)?.province }})<br>
                </p>
                <hr>
                <p>{{ getCategoryItem(appointment.category_id)?.phone }}<br>
                    {{ getCategoryItem(appointment.category_id)?.email }}</p>
                <div class="clearfix"></div>
                <button pButton pRipple icon="pi pi-pencil" label="Modifica Dati Cliente"
                    class="p-button p-button-primary p-mr-2"
                    [routerLink]="['/admin/clients/edit', appointment.category_id]"></button>
            </p-card>
        </div>

    </ng-template>

</p-sidebar>