<p-sidebar [(visible)]="filterSidebar" #op position="right">
    <ng-template pTemplate>
        <div class="p-field p-grid">
            <div class="p-col-12">
                <p-calendar [(ngModel)]="nameFilter" [style]="{ width: '100%' }" placeholder="Data da"
                    dateFormat="yy-mm-dd" dataType="string" inputId="dateformat"></p-calendar>
            </div>
        </div>
        <div class="p-field p-grid">
            <div class="p-col-12">
                <p-calendar [(ngModel)]="descriptionFilter" [style]="{ width: '100%' }" placeholder="Data a"
                    dateFormat="yy-mm-dd" dataType="string" inputId="dateformat"></p-calendar>
            </div>
        </div>

          <div class="p-field p-grid">
            <div class="p-col-6">
                <button pButton type="reset" class="p-button p-button-secondary btn-block"
                label="annulla" (click)="reset()">
            </button>
            </div>

            <div class="p-col-6">
                <button pButton type="submit" class="p-button p-button-primary btn-block"
                label="cerca" (click)="load()">
            </button>
            </div>

        </div>
    </ng-template>
</p-sidebar>

<!-- <div *ngFor="let col of cols" [ngSwitch]="col.field">

    <div class="tag" *ngIf="dt.filters[col.field]">{{dt.filters[col.field]? dt.filters[col.field].value : ''}}</div>
</div> -->

<div class="top-main-wrapper">
    <div class="dash-header">
        <div class="dash-title">
    
            <div class="p-field p-grid">
                <div class="p-col-6 p-md-6">
                    <h3>Progetti</h3>
                </div>
                <div class="p-col-6 p-md-6">
                    <button pButton pRipple icon="pi pi-plus" [routerLink]="['/admin/projects/create']" label="Aggiungi"
                        class="p-button p-button-primary p-mr-2 pull-right"></button>
          
                        <button type="text" pButton label="Filter" icon="pi pi-filter"
                        class="p-button p-button-options p-mr-2 pull-right" (click)="filterSidebar = true"></button>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="main-inner">



<div class="p-fluid">
    <div class="p-field p-grid">
        <div class="p-col-12 p-md-12">

            <p-card>

                <div class="filter-options">

                    <div class="p-field p-grid">

                        <div class="p-col-12 p-md-8">
                            <div class="item-size pull-left">
                                <span class="filter-tag" *ngIf="nameFilter">{{nameFilter}} <span class="close"><i
                                            class="pi pi-times" (click)="reset()"></i></span> </span>
                                <span class="filter-tag" *ngIf="descriptionFilter">{{descriptionFilter}} <span
                                        class="close"><i class="pi pi-times" (click)="reset()"></i></span> </span>
                            </div>
                        </div>

                        <div class="p-col-12 p-md-4">
                            <span class="count-item pull-right">{{count}} Items</span>
                        </div>
                    </div>
                </div>
                <div
                    *ngFor=" let project of projects  | paginate: { itemsPerPage: pageSize, currentPage: page, totalItems: count }; let i = index">
                </div>
                <p-table #dt [columns]="cols" [responsive]="true"  [value]="projects" [paginator]="false"
                    [rows]="10">

                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th width="50"></th>
 
                            <th width="500">Nome Progetto</th>
                            <th ></th>

                            <th width="100">Ore</th>

                            <th  width="160">Importo Progetto</th>

                            <th width="100" ></th>

                        </tr>

                    </ng-template>
                    <ng-template pTemplate="body" let-project>
                        <tr>
                           
                            <td>
                                <app-initials-avatar
                                    firstName="{{project.code_int | slice: 0:1}}"
                                    lastName="{{project.code_int | slice: 1:2}}">
                                </app-initials-avatar>
                            </td>
                            <td>


                                <strong>{{project.title}}</strong>
                                <div class="clearifix"></div>
                                <p class="detail">
                                <i class="pi pi-map"></i> {{project.code_int}} - <i class="pi pi-calendar"></i> {{project.date_from}} al {{project.date_to}}
                            </p>
                            </td>

                            <td>
                                <button pButton pRipple  icon="pi pi-chart-line" label="ProduttivitÃ " class="p-button p-button-secondary p-mr-2"
                                [routerLink]="['/admin/projects/productivity/', project.id]"></button>
                                    
                                
                                    <button pButton pRipple  icon="pi pi-clock" label="HR" class="p-button p-button-primary p-mr-2"
                                    [routerLink]="['/admin/projects/timesheets/', project.id]"></button>  
    
                                    <button pButton pRipple  icon="pi pi-clone" label="Tasks" class="p-button p-button-warning p-mr-2"
                                    [routerLink]="['/admin/projects/task/', project.id]"></button>
                            </td>

                            <td><i class="pi pi-clock"></i> {{project.time}}</td>
                            
                            <td><p-tag value="{{project.price | currency :'EUR':'symbol':'1.2-2'}}"></p-tag>
                     
                            </td>
                           
                          
                            <td class="action">
                                <button pButton pRipple icon="pi pi-pencil" class="p-button p-button-success p-mr-2"
                                    [routerLink]="['/admin/projects/edit', project.id]"></button>
                        
                                <button pButton pRipple icon="pi pi-trash" class="p-button p-button-danger p-mr-2"
                                    (click)="onDelete(project.id)"></button>
                           
                                  
                                </td>
                        </tr>
                    </ng-template>
                </p-table>
                <div class="p-grid">

                    <div class="p-col-12 p-md-12">
                        <pagination-controls previousLabel="Prev" nextLabel="Next" responsive="true"
                            (pageChange)="handlePageChange($event)">
                        </pagination-controls>
                    </div>
                </div>
            </p-card>
        </div>
    </div>
</div>

</div>
{{error}}

<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text" #cd>

    <p-footer>
        <button type="button" pButton icon="fa fa-close" class="p-button p-button-danger p-mr-2" label="No" (click)="cd.reject()"></button>
        <button type="button" pButton icon="fa fa-check" class="p-button p-button-success p-mr-2" label="Si" (click)="cd.accept()"></button>
    </p-footer>

</p-confirmDialog>